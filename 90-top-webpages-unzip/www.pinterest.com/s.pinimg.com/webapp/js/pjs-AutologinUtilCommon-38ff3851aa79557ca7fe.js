(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["AutologinUtilCommon","AuthHandshakeCommon"],{"/TEi":function(e,t,n){"use strict";var o={get:function(e){n.e("ScriptCommon").then(n.bind(null,"91Tc")).then((function(t){var n=t.default;n.load([],"https://apis.google.com/js/client:platform.js","gplus"),n.ready("gplus",(function(){e(window.gapi)}))}))}};t.a=o},"0Ssc":function(e,t,n){"use strict";n.r(t),n.d(t,"fbAutologinCallback",(function(){return I})),n.d(t,"facebookAutoLogin",(function(){return T})),n.d(t,"googleAutologin",(function(){return P})),n.d(t,"googleAutoLogin",(function(){return N}));var o=n("WQSK"),r=n("ztFR"),a=n("Fpqi"),i=n("/TEi"),c=n("3nbW"),u=n("NizT"),s=n("PhUE"),_=n("ggpB"),l=n("q579"),g=n("ZyqP"),d=n("lixz"),f=n("hrsr"),p=n("CUD6");function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){h(e,t,n[t])}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O="facebook",m="google",v=[1201,105,30,82,83,86],k=function(e,t){e=function(e,t){var n=t?{}:{autologin:!0};if(!e&&("/"!==(e=window.location.pathname||"/")&&!t&&Object(g.c)(document.referrer)&&(n.lp="true"),Object.assign(n,l.a.getQueryStringParams()),n)){var o=n.next;o&&(e=o,delete n.next)}return l.a.appendQueryString(e,n)}(e,t),Object(u.a)(e)},E=function(e){Object(_.a)("autologin.".concat(e));var t=r.a.fromPlainObject({event_type:38,view_type:9});t.updateAuxData({login_provider:e,unauth_data:JSON.stringify({autologin:!0})}),a.a.getInstance().addEvent(t)},w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=r.a.fromPlainObject({event_type:e});o.updateAuxData(b({},n?{login_state:2}:{},{signup_login_method:t,unauth_data:JSON.stringify({autologin:!0})})),a.a.getInstance().addEvent(o)},j=function(e){o.set("google"===e?"galae":"fbalae",12,12)};function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];w(7536,2,n);var r=window.nextUrlParam;t||(n&&o&&s.b.sessionStorage.setItem("sessionAutologinMethod","Facebook"),k(r,n))}function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(w(7535,2,t),!v.includes(e.api_error_code))throw e.api_error_code?Object(_.a)("autologin.facebook.uncaught_api_error_code.".concat(e.api_error_code)):Object(_.a)("autologin.facebook.uncaught_with_no_api_error_code"),e;j(O)}function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];w(7536,3,n);var r=window.nextUrlParam;t||(n&&o&&s.b.sessionStorage.setItem("sessionAutologinMethod","Google"),k(r,n))}function y(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(w(7535,3,t),!v.includes(e.api_error_code))throw e.api_error_code?Object(_.a)("autologin.google.uncaught_api_error_code.".concat(e.api_error_code)):Object(_.a)("autologin.google.uncaught_with_no_api_error_code"),e;j(m)}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(o.get("fbalae")){var r=o.get("fbalae");Object(_.a)("autologin.facebook.skip_for_known_api_errors.".concat(r))}else if(Object(_.a)("autologin.facebook_attempt.".concat(t)),"connected"===e.status)if(o.get("fba"))Object(_.a)("autologin.facebook.connected_but_disabled_via_user_cookie");else{var a=e.authResponse;if(!a)return void Object(_.a)("autologin.facebook_fail");E("facebook"),w(7534,2),Object(c.a)({facebook_id:a.userID,facebook_token:a.accessToken,facebook_autologin:!0},{container:"autologinfb"},null).then((function(e){S(e,n)}),A)}}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},u=o.get("fbalae");u?Object(_.a)("autologin.facebook.skip_for_known_api_errors.".concat(u)):(Object(_.a)("autologin.facebook_attempt.".concat(t)),Object(p.b)(e).then((function(e){var t=e.creds,u=o.get("fbalae");u?Object(_.a)("autologin.facebook.skip_for_known_api_errors.".concat(u)):(E("facebook"),w(7534,2,r),Object(c.a)(t,{container:"autologinfb"},null).then((function(e){S(e,n,r,a)}),(function(e){A(e,r),i("facebook")})))}),(function(e){e.status;i("facebook"),Object(_.a)("autologin.facebook_fail")})))}function P(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(o.get("galae")){var s=o.get("galae");Object(_.a)("autologin.google.skip_for_known_api_errors.".concat(s))}else o.get("fba")?Object(_.a)("autologin.google.connected_but_disabled_via_user_cookie"):(Object(d.d)({name:"UnauthGoogleAutologinInitEvent"}),i.a.get((function(o){Object(d.d)({name:"UnauthGoogleAutologinScriptLoadedEvent"}),Object(_.a)("autologin.google_start.".concat(n)),u&&u.check("enabled_simple")||r&&"/pinterest/our-san-francisco-picks/"===r.pathname?(r&&"/pinterest/our-san-francisco-picks/"===r.pathname&&Object(_.a)("autologin.force_pinterest_blp"),Object(f.f)(o,(function(e){return Object(_.a)("autologin.".concat(e))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(_.a)("autologin.google_attempt.".concat(n)),E("google"),w(7534,3),Object(d.d)({name:"UnauthGoogleAutologinSuccessEvent"}),Object(c.a)(e.data,"autologingoogle",null).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,a,!1)}),y)}),(function(e){Object(_.a)("autologin.google_fail.".concat(e))}))):u&&u.check("enabled_blender")?Object(p.d)(e,(function(e){return Object(_.a)("autologin.".concat(e))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(_.a)("autologin.google_attempt.".concat(n)),e.data?(E("google"),w(7534,3),Object(d.d)({name:"UnauthGoogleAutologinSuccessEvent"}),Object(c.a)(e.data,"autologingoogle",null).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,a,!1)}),y)):Object(_.a)("autologin.google_fail")}),(function(e){Object(_.a)("autologin.google_error.".concat(e))})):u&&u.check("enabled_new_api")?Object(p.f)(o,(function(e){return Object(_.a)("autologin.".concat(e))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(_.a)("autologin.google_attempt.".concat(n)),E("google"),w(7534,3),Object(d.d)({name:"UnauthGoogleAutologinSuccessEvent"}),Object(c.a)(e.data,"autologingoogle",null).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,a,!1)}),y)}),(function(e){Object(_.a)("autologin.google_fail.".concat(e))})):function(e,t,n,o,r){r&&r.signin.render(e,{scope:"profile email",clientid:t.GPLUS_CLIENT_ID,apppackagename:t.GPLUS_APP_PACKAGE_NAME,redirecturi:"postmessage",accesstype:"offline",cookiepolicy:"single_host_origin",callback:function(e){Object(_.a)("autologin.google_attempt.".concat(n));var t={gplus_id_token:e.id_token,gplus_access_token:e.access_token,gplus_expires_at:e.expires_at,gplus_autologin:!0};e.status.signed_in?(E("google"),w(7534,3),Object(d.d)({name:"UnauthGoogleAutologinSuccessEvent"}),Object(c.a)(t).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,o)}),y)):Object(_.a)("autologin.google_fail")}})}(e,t,n,a,o)})))}function N(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},s=o.get("galae");s?Object(_.a)("autologin.google.skip_for_known_api_errors.".concat(s)):o.get("fba")?Object(_.a)("autologin.google.connected_but_disabled_via_user_cookie"):(Object(_.a)("autologin.google_attempt.".concat(e)),r?i.a.get((function(e){Object(p.e)(e,(function(e){return Object(_.a)("autologin.limited_login.".concat(e))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.data?(E("google"),w(7534,3,n),Object(c.a)(e.data).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,t,n,a)}),(function(e){y(e,n),u("google")}))):(u("google"),Object(_.a)("autologin.google_fail"))}))})):Object(p.c)((function(e){return Object(_.a)("autologin.limited_login.".concat(e))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.data?(E("google"),w(7534,3,n),Object(c.a)(e.data).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(e,t,n,a)}),(function(e){y(e,n),u("google")}))):(u("google"),Object(_.a)("autologin.google_fail"))})))}},"2XPX":function(e,t,n){"use strict";t.decode=t.parse=n("PAUS"),t.encode=t.stringify=n("I8H7")},"2rhI":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s}));var o=n("hvnN"),r=n.n(o),a=n("QJ2d"),i={FACEBOOK:"facebook",GOOGLE_ONE_TAP:"google_one_tap",GOOGLE:"google",EMAIL:"email",OTHER:"other"},c=function(e){return e.facebook_id?i.FACEBOOK:e.google_open_id_token?i.GOOGLE_ONE_TAP:e.gplus_code||e.gplus_id_token?i.GOOGLE:e.email?i.EMAIL:i.OTHER},u=(r.a.shape({credentials:r.a.shape({}),userData:r.a.shape({}),type:r.a.oneOf(Object.values(i))}),function(e){return e in a.a.settings.MINIMUM_AGE_BY_EU_COUNTRY}),s=function(e){return a.a.settings.EN_COUNTRIES_WITH_MANDATORY_AGE.includes(e)}},"3nbW":function(e,t,n){"use strict";var o=n("f5ca"),r=n("D+W/"),a=n("oFGA"),i=n("/YZq"),c=n("ePT2"),u=n("PhUE"),s=n("ggpB"),_=new Map([[1,"INVALID_PARAMETERS"],[100,"INVALID_NETWORK_ACCESS_TOKEN"],[105,"FACEBOOK_ACCOUNT_NOT_LINKED"],[12,"API_SERVER_ERROR"],[1202,"LOGIN_MFA_TOKEN_INVALID"],[1203,"MFA_CONNECTION_ERROR"],[13,"API_DOWN"],[181,"GPLUS_CONNECTION_ERROR"],[14,"API_SERVER_SPAM_CONTENT"],[16,"API_REQUEST_TIMEOUT"],[50,"API_ERROR_PIN_NOT_FOUND"],[77,"INVALID_PASSWORD_FB_USER"],[78,"INVALID_PASSWORD_ERROR_CODE"],[79,"INVALID_EMAIL_ERROR_CODE"],[80,"INVALID_EMAIL_OR_PASSWORD"],[82,"LOGIN_DEACTIVATED_USER"],[83,"LOGIN_POLICY_VIOLATION_USER"],[85,"AUTO_PASSWORD_RESET_ERROR_CODE"],[86,"LOGIN_PANICKED_USER"],[87,"LOGIN_SOFT_BANNED_USER"],[93,"API_ERROR_UNDERAGE_REGISTER_ATTEMPT"],[99,"LOGIN_PASSWORD_NOT_CREATED"],[8,"API_LIMIT_EXCEEDED_ERROR"],[9,"API_EVENT_BLOCKED_ERROR"],[19,"USER_IN_SAFE_MODE"],[84,"LOGIN_VOLUNTARILY_DEACTIVATED_USER"],[85,"LOGIN_BAD_PASSWORD_ASK_RESET"],[1201,"LOGIN_MFA_REQUIRED"],[30,"LOGIN_USER_NOT_FOUND"],[88,"LOGIN_HARD_BANNED_USER"],[429,"RESPONSE_CODE_TOO_MANY_REQUESTS"]]);function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown_source",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){var a=e.http_status===r.a.RESPONSE_CODE_TOO_MANY_REQUESTS?r.a.RESPONSE_CODE_TOO_MANY_REQUESTS:e.api_error_code,i=a;_.has(a)&&(i=_.get(a));var c=t.container;o?Object(s.a)("unauth_web_client_cctld_login_api_error.".concat(String(i),".").concat(c||"unknow_container",".").concat(n)):Object(s.a)("unauth_web_client_login_api_error.".concat(String(i),".").concat(c||"unknow_container",".").concat(n))}}var g=n("DU5A"),d=n("2rhI"),f=n("HLgS");function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){b(e,t,n[t])}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=i.a.getLogger("UserLogin"),O=i.a.getLogger("AuthHandshake"),m=function(e){return e.mfa_token?"mfa_token":e.mfa_resend?"mfa_resend":e.facebook_id?d.a.FACEBOOK:e.google_open_id_token?d.a.GOOGLE_ONE_TAP:e.gplus_id_token?d.a.GOOGLE:e.phone_number?"phone_number":e.username_or_email?d.a.EMAIL:d.a.OTHER},v=function(e,t){var n="referrer_unknown";try{var o=document.referrer;n=o?o.indexOf("/t.co/")>-1?"twitter":o.indexOf("google.")>-1?"google":o.indexOf("bing.")>-1?"bing":o.indexOf("facebook.")>-1?"facebook":"other":"direct"}catch(_){}var r=m(e),a=t===Object(t)?t.hybridTier:"tier_unknown",i=t===Object(t)?t.container:"container_unknown";Object(s.a)("login.referrer."+n+"."+r),Object(s.a)("login.container."+i+"."+r),Object(s.a)("login.type."+r);var c=m(e)||"method_unknown",u=t.page||"page_unknown";e.gplus_autologin?Object(s.a)("web_autologin_google"):e.facebook_autologin?Object(s.a)("web_autologin_facebook"):Object(s.a)("web_login.".concat(c,".success.").concat(u,".").concat(i,".").concat(n,".").concat(a))},k=function(e,t){Object(s.a)("web_cross_domain_login.".concat(e,".").concat(m(t)))},E=function(e){return!e.mfa_resend&&!!e.username_or_email},w=function(e,t){return k("attempt",e),o.default.loginUser(e).then((function(n){if(n&&n.data){k("success_with_token",e);var r=n.data;return o.default.exchangeTokenAndSetSession(r).then((function(n){return k("success_token_exchanged",e),v(e,t),O.debug("Cross domain login successful"),Promise.resolve()}),(function(t){throw k("success_token_not_exchanged",e),O.error("Failed to set session for current user; "+t.message),t}))}throw k("success_without_token",e),O.error("No custom access token in cross domain login response"),new Error}),(function(n){throw k("failure",e),l(n,t,m(e),!0),O.error("Failed to login user; "+n.message),n}))};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]),o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;if(E(e)){var s=r.a.GEN.templateConst.settings.CORS_HANDSHAKE_DOMAINS;if(-1!==s.indexOf(a.a.instance.origin))return w(e,t)}e.switch_account&&(e.get_user=!!n||e.get_user);var _=n?null:u.b.localStorage.getItem("visitedPagesBeforeLogin"),d=p({},e,{app_type_from_client:5,visited_pages_before_login:_?JSON.stringify(_):null,recaptchaToken:o,tokenV3:i}),b=c.a.create("UserSessionResource",d),O={showError:!1,async:!0};return b.callCreate(O).then((function(n){return h.debug("Login, successful",n),v(e,t),Object(g.g)(!1),Object(f.b)("login").then((function(){return n}))}),(function(n){return l(n,t,m(e)),Promise.reject(n)}))}},C5uM:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return g}));var o=n("G8/I");function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){a(e,t,n[t])}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=["picture.type(large)","id","first_name","last_name","email","gender","birthday"],c=["public_profile","email","user_likes","user_birthday","user_friends"],u=function(e){return Object(o.c)("//connect.facebook.net/".concat(function(e){var t=e;switch(t=t.replace(/-/g,"_")){case"de":t="de_DE";break;case"fr":t="fr_FR";break;case"it":t="it_IT";break;case"ja":t="ja_JP";break;case"nl":t="nl_NL";break;case"tr":t="tr_TR";break;case"en_AU":t="en_US";break;case"es_419":case"es_AR":t="es_LA"}return t}(e),"/sdk.js"),o.a.FACEBOOK).then((function(){window.FB.init({appId:"274266067164",status:!0,xfbml:!0,version:"v2.7"})}))},s=function(){return new Promise((function(e){window.FB.getLoginStatus(e)}))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(o,a){if("connected"===e.status){var c=e.authResponse,u={facebook_id:c.userID,facebook_token:c.accessToken,facebook_autologin:t.autologin||!1},s="/me?fields=".concat(i.join(","));n&&n("login_status.connected"),window.FB.api(s,(function(e){o({creds:u,data:r({},e,u,e.picture&&!e.picture.data.is_silhouette?{image_url:e.picture.data.url}:{})})}))}else{var _=e.status||"unknown";n&&n("login_status.".concat(_)),a({status:_})}}))},l=function(e,t){var n=e.data;e.isTrusted&&"string"==typeof n&&0===n.indexOf("_FB_")&&-1!==n.indexOf("type=login_button_dialog_open")&&t&&t("facebook_connect.login_button_dialog_open")},g=function(e){return new Promise((function(t,n){window.FB.api("/me/permissions",(function(o){var r=o.data;if(r){var a=r.find((function(t){return t.permission===e&&"granted"===t.status}));return t({hasPerm:!!a})}return n(Error("Failed to call facebook to get permission"))}))}))}},CUD6:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return d}));var o=n("RdRb"),r=n("C5uM"),a=n("hrsr"),i=n("Tb0h"),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=window.navigator.credentials,r={password:!0};return t&&(r.mediation=t),Object(o.b)()?Promise.reject({status:"autologin_disabled"}):new Promise((function(t){n?(e&&e.onAttempt&&e.onAttempt(),n.get(r).then(t)):e&&e.onNoBrowserCredentials&&e.onNoBrowserCredentials()}))},u=function(e){return Object(o.b)()?Promise.reject({status:"autologin_disabled"}):Object(r.e)(e).then(r.c).then((function(e){return Object(r.d)(e,{autologin:!0})}))},s=function(e){if(Object(o.b)())return Promise.reject({status:"autologin_disabled"});e&&e("autologin.create_google_autologin_button.number_5");var t=document.createElement("div");return t.style.left="-99999px",t.style.opacity="0",t.style.position="fixed",t.style.top="-999999px",document.getElementsByTagName("body")[0].appendChild(t),Object(a.b)(t,!0)},_=function(e,t){if(Object(o.b)())return Promise.reject({status:"autologin_disabled"});t("create_google_autologin_button.number_6");var n=document.createElement("div");return n.style.left="-99999px",n.style.opacity="0",n.style.position="fixed",n.style.top="-999999px",n.id="google-autologin-button",document.getElementsByTagName("body")[0].appendChild(n),Object(a.c)(n.id,e,t,!0)},l=function(e,t){return Object(o.b)()?Promise.reject({status:"autologin_disabled"}):(t("create_google_autologin_button.number_7"),Object(a.d)(e,t,!0))},g=function(e,t){return t&&t("autologin.create_google_autologin_button.number_8"),Object(a.e)(e,t)},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!Object(i.b)(window.location.origin)||Object(o.b)()?Promise.reject({status:"autologin_disabled"}):(e&&e.onAttempt&&e.onAttempt(),Object(i.c)())}},DU5A:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return _})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return b}));var o=n("WQSK"),r=n("PhUE"),a=n("2cJX");function i(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";arguments.length>3&&arguments[3],arguments.length>4&&arguments[4];return t?a.a.tier1:n&&n.includes("yahoo.co.jp")&&"JP"===e?a.a.tier1:(e=e||"",a.e.has(e)?a.a.tier1:a.g.has(e)?a.a.tier2:a.a.tier3)}function c(){o.set("hasBeenShownLoginModalInOpen","true",a.c)}function u(e){r.b.sessionStorage.setItem("uimb",!!e)}function s(){return r.b.sessionStorage.getItem("uimb")||!1}function _(e){return void 0!==e&&r.b.sessionStorage.setItem("mdfu",e),r.b.sessionStorage.getItem("mdfu")||0}function l(e){r.b.sessionStorage.setItem("siou",!!e)}var g=!1;function d(e){g=!!e}function f(e){r.b.localStorage.setItem("uoiou",!!e)}function p(){return r.b.localStorage.getItem("uoiou")||!1}function b(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p()||r.b.sessionStorage.getItem("siou")||!1||g||!1||!e&&s()}},"G8/I":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}));var o=n("E56J"),r=20,a=100,i=.01,c=Object.freeze({OTHER:0,FACEBOOK:1,GPLUS_ONE:2});function u(e){return new Promise((function(t,n){if(document.querySelector('script[src="'.concat(e,'"]')))t();else{var o=document.createElement("script");o.src=e,o.async=!0,o.addEventListener("load",t),o.addEventListener("error",n),document.getElementsByTagName("head")[0].appendChild(o)}}))}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.OTHER,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"web":"mweb";return new Promise((function(u,s){if(document.querySelector('script[src="'.concat(e,'"]'))){var _=0;if(t===c.GPLUS_ONE)if(window.gapi)u();else var l=setInterval((function(){window.gapi||_===r?(clearInterval(l),u()):(_+=1,o.a.increment("".concat(n,".loadScript.gplus_one.tries_").concat(_),i))}),a);else if(t===c.FACEBOOK)if(window.FB)u();else var g=setInterval((function(){window.FB||_===r?(clearInterval(g),u()):(_+=1,o.a.increment("".concat(n,".loadScript.facebook.tries_").concat(_),i))}),a);else u()}else{var d=document.createElement("script");d.src=e,d.async=!0,d.addEventListener("load",u),d.addEventListener("error",s),document.getElementsByTagName("head")[0].appendChild(d)}}))}},I8H7:function(e,t,n){"use strict";var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?a(i(e),(function(i){var c=encodeURIComponent(o(i))+n;return r(e[i])?a(e[i],(function(e){return c+encodeURIComponent(o(e))})).join(t):c+encodeURIComponent(o(e[i]))})).join(t):c?encodeURIComponent(o(c))+n+encodeURIComponent(o(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o++)n.push(t(e[o],o));return n}var i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},PAUS:function(e,t,n){"use strict";function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var c=/\+/g;e=e.split(t);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var _=0;_<s;++_){var l,g,d,f,p=e[_].replace(c,"%20"),b=p.indexOf(n);b>=0?(l=p.substr(0,b),g=p.substr(b+1)):(l=p,g=""),d=decodeURIComponent(l),f=decodeURIComponent(g),o(i,d)?r(i[d])?i[d].push(f):i[d]=[i[d],f]:i[d]=f}return i};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},RdRb:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var o=n("WQSK"),r=function(){return!!o.get("logged_out")||!!o.get("fba")},a=101},Tb0h:function(e,t,n){"use strict";var o=n("ePT2"),r=n("QJ2d");function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e){return Object.keys(e).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))})).join("&")},c=function(e,t,n){return new Promise((function(o,r){var i=new XMLHttpRequest;i.withCredentials=!0,i.open(t,e),"POST"===t&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),i.onload=function(){try{var e=JSON.parse(i.responseText);"success"===e.status?o(e):r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){a(e,t,n[t])}))}return e}({apiErrorCode:e.code,httpStatus:i.status},e))}catch(t){r({httpStatus:i.status,message:t.message})}},i.onerror=function(){return r(i.statusText)},i.send(n)}))};n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return l}));var u=function(e){return r.a.settings.CORS_HANDSHAKE_DOMAINS.includes(e)},s=function(e){return o.a.create("HandshakeSessionResource",{token:e,get_user:!0}).callCreate()},_=function(e){var t={},n=e.facebook_id?"facebook/handshake":e.gplus_id_token?"gplus/handshake":e.mfa_token?"mfa/handshake":"handshake";if(e.username_or_email&&(t.username_or_email=e.username_or_email.trim(),t.password=e.password,t.referrer=e.referrer),e.facebook_id){var o=e.facebook_token||"";t.facebook_id=e.facebook_id,t.facebook_token=o,t.facebook_autologin=e.facebook_autologin||!1}return e.gplus_id_token&&(t.gplus_id_token=e.gplus_id_token,t.gplus_access_token=e.gplus_access_token,t.gplus_expires_at=e.gplus_expires_at,t.gplus_autologin=e.gplus_autologin||!1),e.mfa_token&&(t.mfa_token=e.mfa_token),c("".concat(r.a.settings.ACCOUNTS_PINTEREST_URL,"/v3/login/").concat(n,"/"),"POST",i(t)).then((function(e){if(e&&e.data)return s(e.data);throw new Error("No custom access token in cross domain login response")})).catch((function(e){throw e}))},l=function(){return c("".concat(r.a.settings.ACCOUNTS_PINTEREST_URL,"/v3/handshake/verify/"),"GET").then((function(e){if(e&&e.data)return s(e.data);throw new Error("No custom access token in cross domain verify response")})).catch((function(e){throw e}))}},ZyqP:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s}));var o=n("VSY/"),r=n("Qo1m"),a=n("q579");function i(e,t,n,o){var r=e.url_name,a=t.startsWith("/explore/")||!n?"/explore/":"/topics/",i="".concat(a).concat(r,"/");if("en-us"===o.toLowerCase())return i;var c=e.name.replace(/ /g,"-").toLowerCase();return r===c?i:"".concat(a).concat(c,"-").concat(e.id,"/")}function c(e){var t=function(e){var t=a.a.parse(e,!0).hostname;if(t&&e){if(e.match(/^(http|https):\/\/(www.)?google\.com$|google\.(co|com)\.[a-z]{2}$|google\.[a-z]{2}$/))return"GOOGLE";if(t.includes("bing."))return"BING";if(t.includes("yahoo."))return"YAHOO"}return""}(e);return["GOOGLE","BING","YAHOO"].includes(t)}function u(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>|<!--[\s\S]*/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,(function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""}))}function s(){var e=o.c(r.a._("<strong>Halloween</strong><br/ ><span>videos for you</span>"),{}),t=r.a._("The Best Halloween Videos in 2019"),n=r.a._("Find the best Halloween costume ideas, DIY costumes, and more.");return{type:"holidayCard",title:e,anchorTitle:t,buttonText:r.a._("Watch videos"),link:"/pinterest_celebrations/halloween-videos/",description:n,image:{url:"https://i.pinimg.com/236x/c6/df/a7/c6dfa72976eb38faff6caa22d3ad4f00.jpg",width:236,height:384}}}},f5ca:function(e,t,n){"use strict";n.r(t);n("oiDG");var o=n("XQD6"),r=n("D+W/"),a=n("oFGA"),i=n("/YZq"),c=n("2XPX"),u=n.n(c),s=n("ePT2"),_=n("ggpB"),l=n("q579"),g=i.a.getLogger("AuthHandshake"),d={_parseJson:function(e){return e.json()},_throwError:function(e){var t=new Error(e.statusText);throw t.response=e,d._reconstructError(t),t},_checkStatus:function(e){return 200===e.status||401===e.status?e:(d._throwError(e),{})},_crossDomainRequest:function(e,t,n){if("GET"!==n&&"POST"!==n)return Promise.resolve({});var o={credentials:"include",mode:"cors"};return"POST"===n&&(o.method="POST",o.body=t,o.headers={"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","X-Pinterest-InstallId":a.a.instance.unauth_id},a.a.instance.unauth_id||Object(_.a)("unauth.auth_handshake.cross_domain.no_unauth_id.".concat(n))),fetch(e,o).then(d._checkStatus).then(d._parseJson).then((function(e){return"success"===e.status?Promise.resolve(e):e.code===r.a.LOGIN_MFA_REQUIRED?(e.api_error_code=e.code,Promise.reject(e)):(d._throwError(e),{})})).catch((function(e){throw e}))},_reconstructError:function(e){!e.api_error_code&&e.response&&(e.api_error_code=e.response.code,e.message=e.response.message)},_shouldRedirectToCanonical:function(){var e=r.a.GEN.templateConst.settings.ACCOUNTS_PINTEREST_URL+"/v3/handshake/canonical/";return d._crossDomainRequest(e,"","GET")},_redirectToCanonical:function(){var e="";if(window.location.search){var t=u.a.parse(window.location.search.substring(1));t.originalUrl&&(e=t.originalUrl)}e||(e=window.location.pathname+window.location.search),e.startsWith("/")||(e="/".concat(e));var n=r.a.GEN.templateConst.settings.CANONICAL_MAIN_URL;Object(o.a)("".concat(n).concat(e))},verifyAndRedirectToCanonical:function(){return d._shouldRedirectToCanonical().then((function(e){e&&e.data&&d._redirectToCanonical()}))},_verifyAndGetToken:function(){var e=r.a.GEN.templateConst.settings.ACCOUNTS_PINTEREST_URL+"/v3/handshake/verify/";return d._crossDomainRequest(e,"","GET")},exchangeTokenAndSetSession:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.a.create("HandshakeSessionResource",{token:e,isRegistration:t});return n.callCreate()},verifyLoggedInStatus:function(){d._verifyAndGetToken().then((function(e){if(e&&e.data){var t=e.data;d.exchangeTokenAndSetSession(t).then((function(e){window.location.reload()}),(function(e){g.error("Failed to set session for current user; "+e.message)}))}else g.error("No custom access token in cross domain verify response")}),(function(e){}))},_setUpRegisterParameters:function(e){var t={};if(t.email=e.email||"",t.username=e.username||"",t.password=e.password||"",t.first_name=e.first_name||"",t.last_name=e.last_name||"",t.country=e.country||"",t.locale=a.a.instance.locale,t.referrer=a.a.instance.referrer,e.age){var n=new Date;n.setFullYear(n.getFullYear()-e.age);var o=parseInt(n/1e3,10);t.birthday=o.toString()}if(e.custom_gender&&(t.custom_gender=e.custom_gender),e.gender&&(t.gender=e.gender),e.business_name&&(t.account_type=e.account_type,t.business_name=e.business_name,t.first_name=e.business_name),a.a.instance.invite_code&&(t.invite_code=a.a.instance.invite_code),e.facebook_id){var r=a.a.instance.facebook_token||e.facebook_token||"";r||g.debug("Facebook token is not being set during login call."),t.facebook_id=e.facebook_id,t.facebook_token=r,t.social_username=e.social_username||""}else(e.gplus_code||e.gplus_id_token)&&(t.password=e.password||"",t.one_time_code=e.gplus_code,t.id_token=e.gplus_id_token,t.redirect_uri=e.gplus_redirect_uri);return l.a.getQueryStringFromObject(t)},_setUpLoginParameters:function(e){var t={};if(e.username_or_email&&(t.username_or_email=e.username_or_email.trim(),t.password=e.password,t.referrer=a.a.instance.referrer),e.facebook_id){var n=a.a.instance.facebook_token||e.facebook_token||"";n||g.debug("Facebook token is not being set during login call."),t.facebook_id=e.facebook_id,t.facebook_token=n,t.facebook_autologin=e.facebook_autologin||!1}return e.gplus_id_token&&(t.gplus_id_token=e.gplus_id_token,t.gplus_access_token=e.gplus_access_token,t.gplus_expires_at=e.gplus_expires_at,t.gplus_autologin=e.gplus_autologin||!1),e.mfa_token&&(t.mfa_token=e.mfa_token),l.a.getQueryStringFromObject(t)},_getRegisterRequestUrl:function(e){var t="/v3/register/email/handshake/";return e.facebook_id&&(t="/v3/register/facebook/handshake/"),(e.gplus_code||e.gplus_id_token)&&(t="/v3/register/gplus/handshake/"),e.business_name&&(t="/v3/register/partner/handshake/"),r.a.GEN.templateConst.settings.ACCOUNTS_PINTEREST_URL+t},_getLoginRequestUrl:function(e){var t="/v3/login/handshake/";return e.facebook_id&&(t="/v3/login/facebook/handshake/"),e.gplus_id_token&&(t="/v3/login/gplus/handshake/"),e.mfa_token&&(t="/v3/login/mfa/handshake/"),r.a.GEN.templateConst.settings.ACCOUNTS_PINTEREST_URL+t},registerUser:function(e){var t=d._getRegisterRequestUrl(e),n=d._setUpRegisterParameters(e);return d._crossDomainRequest(t,n,"POST")},loginUser:function(e){var t=d._getLoginRequestUrl(e),n=d._setUpLoginParameters(e);return d._crossDomainRequest(t,n,"POST")}};t.default=d},hrsr:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return h}));var o=n("RdRb"),r=n("G8/I"),a="postmessage",i="profile email",c="694505692171-31closf3bcmlt59aeulg2j81ej68j6hk.apps.googleusercontent.com",u="com.pinterest",s="offline",_="single_host_origin",l=function(){return Object(r.c)("https://apis.google.com/js/client:platform.js",r.a.GPLUS_ONE)};function g(e){var t={scope:i,client_id:c,app_package_name:u,access_type:s,cookie_policy:_},n=function(t){e&&e(t)};return new Promise((function(e,o){l().then((function(){n("google_script_load"),window.gapi.auth2?(n("google_script_init_onuse"),window.gapi.auth2.init(t).then((function(t){n("google_init_success"),e(t)}),(function(e){var t=e.error;n("google_init_error"),o("init_onuse_".concat(t))}))):(n("google_script_init_exists"),window.gapi.load("auth2",{callback:function(){n("google_auth2_load_complete"),window.gapi.auth2.init(t).then((function(t){n("google_init_success"),e(t)}),(function(e){var t=e.error;n("google_init_error"),o("init_exists_".concat(t))}))},onerror:function(e){var t=e.error;n("google_auth2_script_load_error"),o(t)},timeout:15e3,ontimeout:function(){n("google_auth2_script_load_timeout"),o("timeout")}}))}))}))}function d(e,t){return function(e,t){return new Promise((function(n,r){Object(o.b)()?r():(t("init_google_button_v4"),t("google_button_init"),g(t).then((function(){t("google_sdk_load"),window.gapi.signin.render(e,{scope:i,clientid:c,apppackagename:u,redirecturi:a,accesstype:s,cookiepolicy:_,callback:function(e){t("callback_response");var o=e.status,r=o.signed_in?{data:{gplus_id_token:e.id_token,gplus_access_token:e.access_token,gplus_expires_at:e.expires_at,gplus_autologin:!0},signupOptions:{gplus_code:e.code,gplus_id_token:e.id_token,gplus_redirect_uri:a}}:{};o.signed_in?t("google_auth_data_found"):t("gplus_user_not_logged_in"),n(r)}})}),(function(e){t("google_auth2_sdk_init_error"),r(e)})))}))}(e,t)}function f(e,t){return function(e,t,n){return new Promise((function(r,i){t&&Object(o.b)()?i():l().then((function(){window.gapi.signin.render(e,{scope:n,clientid:c,apppackagename:u,redirecturi:a,accesstype:s,cookiepolicy:_,callback:function(e){var n=e.status,o=n.signed_in?{data:{gplus_id_token:e.id_token,gplus_access_token:e.access_token,gplus_expires_at:e.expires_at,gplus_autologin:t||!1},signupOptions:{gplus_code:e.code,gplus_id_token:e.id_token,gplus_redirect_uri:a}}:{};(n.signed_in||t)&&r(o)}})}))}))}(e,t,i)}function p(e,t,n){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(c,u){r&&Object(o.b)()?u():(n("google_button_init"),g(n).then((function(){n("google_sdk_load"),t.signin2.render(e,{scope:i,onsuccess:function(e){n("google_button_success");var t=e.getAuthResponse(!0),o={data:{gplus_id_token:t.id_token,gplus_access_token:t.access_token,gplus_expires_at:t.expires_at,gplus_autologin:r||!1},signupOptions:{gplus_code:"",gplus_id_token:t.id_token,gplus_redirect_uri:a}};c(o)},onfailure:function(){n("google_button_failure"),u("gapi_signin2_render_error")}})}),(function(e){n("google_auth2_sdk_init_error"),u(e)})))}))}(e,t,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}function b(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(e,r){n&&Object(o.b)()?r():(t("google_button_init"),g(t).then((function(o){t("google_sdk_load");var a=o.currentUser.get();a&&a.Zi||r("gplus_user_not_found");var i=a.getAuthResponse(!0);if(i){t("google_auth_data_found");var c={data:{gplus_id_token:i.id_token,gplus_access_token:i.access_token,gplus_expires_at:i.expires_at,gplus_autologin:n||!1}};e(c)}r("gplus_user_not_logged_in")}),(function(e){t("google_auth2_sdk_init_error"),r(e)})))}))}(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}function h(e,t){return new Promise((function(e,n){Object(o.b)()?n():(t("google_button_init"),function(e){var t={scope:i,client_id:c,app_package_name:u,access_type:s,cookie_policy:_};return new Promise((function(n,o){e("google_script_fetch"),Object(r.c)("https://apis.google.com/js/platform.js",r.a.GPLUS_ONE).then((function(){e("google_script_load"),window.gapi.load("auth2",{callback:function(){e("google_auth2_load");var r=window.gapi.auth2.init(t);r.then((function(){e("google_init_success"),n(r)}),(function(t){var n=t.error;e("google_init_error"),o("init_exists_".concat(n))}))},onerror:function(t){var n=t.error;e("google_auth2_script_load_error"),o(n)},timeout:15e3,ontimeout:function(){e("google_auth2_script_load_timeout"),o("timeout")}})}))}))}(t).then((function(o){t("google_sdk_load");var r=o.currentUser.get();r&&r.Zi||n("gplus_user_not_found");var a=r.getAuthResponse(!0);if(a){t("google_auth_data_found");var i={data:{gplus_id_token:a.id_token,gplus_access_token:a.access_token,gplus_expires_at:a.expires_at,gplus_autologin:!0}};e(i)}t("google_auth_data_not_found"),n("gplus_user_not_logged_in")}),(function(e){t("google_auth2_sdk_init_error"),n(e)})))}))}}}]);
//# sourceMappingURL=pjs-AutologinUtilCommon-38ff3851aa79557ca7fe.js.map
